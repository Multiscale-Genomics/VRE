//>>built
require({cache:{"JBrowse/Model/DataView":function(){define("JBrowse/Model/DataView",["jDataView"],function(p){var f=function(){p.apply(this,arguments)};try{f.prototype=new p(new ArrayBuffer([1]),0,1)}catch(a){console.error(a)}f.prototype.getUint64Approx=function(a,k){var h=this._getBytes(8,a,k),c=h[0]*Math.pow(2,56)+h[1]*Math.pow(2,48)+h[2]*Math.pow(2,40)+h[3]*Math.pow(2,32)+h[4]*Math.pow(2,24)+(h[5]<<16)+(h[6]<<8)+h[7];if(h[0]||h[1]&224)c=new Number(c),c.overflow=!0;return c};f.prototype.getUint64=
function(a,k){var h=this.getUint64Approx(a,k);if(h.overflow)throw Error("integer overflow");return h};return f})},"jDataView/jdataview":function(){define("jDataView/jdataview",[],function(){var p={};(function(f){var a={ArrayBuffer:"undefined"!==typeof ArrayBuffer,DataView:"undefined"!==typeof DataView&&("getFloat64"in DataView.prototype||"getFloat64"in new DataView(new ArrayBuffer(1))),NodeBuffer:"undefined"!==typeof Buffer&&"readInt16LE"in Buffer.prototype},d={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,
Uint32:4,Float32:4,Float64:8},k={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"},h=function(c,o,b,g){if(!(this instanceof h))throw Error("jDataView constructor may not be called as a function");this.buffer=c;if(!(a.NodeBuffer&&c instanceof Buffer)&&!(a.ArrayBuffer&&c instanceof ArrayBuffer)&&"string"!==typeof c)throw new TypeError("jDataView buffer has an incompatible type");this._isArrayBuffer=a.ArrayBuffer&&c instanceof ArrayBuffer;
this._isDataView=a.DataView&&this._isArrayBuffer;this._isNodeBuffer=a.NodeBuffer&&c instanceof Buffer;this._littleEndian=Boolean(g);var j=this._isArrayBuffer?c.byteLength:c.length;void 0===o&&(o=0);this.byteOffset=o;void 0===b&&(b=j-o);this.byteLength=b;if(!this._isDataView){if("number"!==typeof o)throw new TypeError("jDataView byteOffset is not a number");if("number"!==typeof b)throw new TypeError("jDataView byteLength is not a number");if(0>o)throw Error("jDataView byteOffset is negative");if(0>
b)throw Error("jDataView byteLength is negative");}if(this._isDataView)this._view=new DataView(c,o,b),this._start=0;this._start=o;if(o+b>j)throw Error("jDataView (byteOffset + byteLength) value is out of bounds");this._offset=0;if(this._isDataView)for(var m in d)d.hasOwnProperty(m)&&function(j,e){var i=d[j];e["get"+j]=function(l,b){if(void 0===b)b=e._littleEndian;if(void 0===l)l=e._offset;e._offset=l+i;return e._view["get"+j](l,b)}}(m,this);else if(this._isNodeBuffer&&a.NodeBuffer)for(m in d)d.hasOwnProperty(m)&&
function(j,e,i){var b=d[j];e["get"+j]=function(j){if(void 0===j)j=e._offset;e._offset=j+b;return e.buffer[i](e._start+j)}}(m,this,"Int8"===m||"Uint8"===m?"read"+k[m]:g?"read"+k[m]+"LE":"read"+k[m]+"BE");else for(m in d)d.hasOwnProperty(m)&&function(j,e){var i=d[j];e["get"+j]=function(b,c){if(void 0===c)c=e._littleEndian;if(void 0===b)b=e._offset;e._offset=b+i;if(e._isArrayBuffer&&0===(e._start+b)%i&&(1===i||c))return(new f[j+"Array"](e.buffer,e._start+b,1))[0];if("number"!==typeof b)throw new TypeError("jDataView byteOffset is not a number");
if(b+i>e.byteLength)throw Error("jDataView (byteOffset + size) value is out of bounds");return e["_get"+j](e._start+b,c)}}(m,this)};h.createBuffer=a.NodeBuffer?function(){return new Buffer(arguments)}:a.ArrayBuffer?function(){return(new Uint8Array(arguments)).buffer}:function(){return String.fromCharCode.apply(null,arguments)};h.prototype={compatibility:a,_getBytes:function(c,a,b){var g;if(void 0===b)b=this._littleEndian;if(void 0===a)a=this._offset;if("number"!==typeof a)throw new TypeError("jDataView byteOffset is not a number");
if(0>c||a+c>this.byteLength)throw Error("jDataView length or (byteOffset+length) value is out of bounds");a+=this._start;this._isArrayBuffer?g=new Uint8Array(this.buffer,a,c):(g=this.buffer.slice(a,a+c),this._isNodeBuffer||(g=Array.prototype.map.call(g,function(j){return j.charCodeAt(0)&255})));b&&1<c&&(g instanceof Array||(g=Array.prototype.slice.call(g)),g.reverse());this._offset=a-this._start+c;return g},getBytes:function(c,a,b){var g=this._getBytes.apply(this,arguments);g instanceof Array||(g=
Array.prototype.slice.call(g));return g},getString:function(c,a){var b;if(this._isNodeBuffer){if(void 0===a)a=this._offset;if("number"!==typeof a)throw new TypeError("jDataView byteOffset is not a number");if(0>c||a+c>this.byteLength)throw Error("jDataView length or (byteOffset+length) value is out of bounds");b=this.buffer.toString("ascii",this._start+a,this._start+a+c);this._offset=a+c}else b=String.fromCharCode.apply(null,this._getBytes(c,a,!1));return b},getChar:function(c){return this.getString(1,
c)},tell:function(){return this._offset},seek:function(c){if("number"!==typeof c)throw new TypeError("jDataView byteOffset is not a number");if(0>c||c>this.byteLength)throw Error("jDataView byteOffset value is out of bounds");return this._offset=c},_getFloat64:function(c,a){var b=this._getBytes(8,c,a),g=1-2*(b[0]>>7),j=((b[0]<<1&255)<<3|b[1]>>4)-(Math.pow(2,10)-1),b=(b[1]&15)*Math.pow(2,48)+b[2]*Math.pow(2,40)+b[3]*Math.pow(2,32)+b[4]*Math.pow(2,24)+b[5]*Math.pow(2,16)+b[6]*Math.pow(2,8)+b[7];return 1024===
j?0!==b?NaN:Infinity*g:-1023===j?g*b*Math.pow(2,-1074):g*(1+b*Math.pow(2,-52))*Math.pow(2,j)},_getFloat32:function(c,a){var b=this._getBytes(4,c,a),g=1-2*(b[0]>>7),j=(b[0]<<1&255|b[1]>>7)-127,b=(b[1]&127)<<16|b[2]<<8|b[3];return 128===j?0!==b?NaN:Infinity*g:-127===j?g*b*Math.pow(2,-149):g*(1+b*Math.pow(2,-23))*Math.pow(2,j)},_getInt32:function(a,d){var b=this._getUint32(a,d);return b>Math.pow(2,31)-1?b-Math.pow(2,32):b},_getUint32:function(a,d){var b=this._getBytes(4,a,d);return b[0]*Math.pow(2,24)+
(b[1]<<16)+(b[2]<<8)+b[3]},_getInt16:function(a,d){var b=this._getUint16(a,d);return b>Math.pow(2,15)-1?b-Math.pow(2,16):b},_getUint16:function(a,d){var b=this._getBytes(2,a,d);return(b[0]<<8)+b[1]},_getInt8:function(a){a=this._getUint8(a);return a>Math.pow(2,7)-1?a-Math.pow(2,8):a},_getUint8:function(a){return this._getBytes(1,a)[0]}};"undefined"!==typeof jQuery&&"1.6.2"<=jQuery.fn.jquery&&(jQuery.ajaxSetup({converters:{"* dataview":function(a){return new h(a)}},accepts:{dataview:"text/plain; charset=x-user-defined"},
responseHandler:{dataview:function(a,d,b){var g;if("mozResponseArrayBuffer"in b)g=b.mozResponseArrayBuffer;else if("responseType"in b&&"arraybuffer"===b.responseType&&b.response)g=b.response;else if("responseBody"in b){d=b.responseBody;try{g=IEBinaryToArray_ByteStr(d)}catch(j){window.execScript("Function IEBinaryToArray_ByteStr(Binary)\r\n\tIEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n\tDim lastIndex\r\n\tlastIndex = LenB(Binary)\r\n\tif lastIndex mod 2 Then\r\n\t\tIEBinaryToArray_ByteStr_Last = AscB( MidB( Binary, lastIndex, 1 ) )\r\n\tElse\r\n\t\tIEBinaryToArray_ByteStr_Last = -1\r\n\tEnd If\r\nEnd Function\r\n",
"vbscript"),g=IEBinaryToArray_ByteStr(d)}for(var d=IEBinaryToArray_ByteStr_Last(d),b="",m=0,q=g.length%8,e;m<q;)e=g.charCodeAt(m++),b+=String.fromCharCode(e&255,e>>8);for(q=g.length;m<q;)b+=String.fromCharCode((e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8,(e=g.charCodeAt(m++),e&255),e>>8);-1<d&&(b+=String.fromCharCode(d));
g=b}else g=b.responseText;a.text=g}}}),jQuery.ajaxPrefilter("dataview",function(a){if(jQuery.support.ajaxResponseType){if(!a.hasOwnProperty("xhrFields"))a.xhrFields={};a.xhrFields.responseType="arraybuffer"}a.mimeType="text/plain; charset=x-user-defined"}));f.jDataView=(f.module||{}).exports=h;if("undefined"!==typeof module)module.exports=h})(p);return p.jDataView})},"JBrowse/Store/SeqFeature/BigWig/Window":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","./RequestWorker"],
function(p,f,a,d){return p(null,{constructor:function(a,d,c,f){this.bwg=a;if(!(0<=d))throw"invalid cirTreeOffset!";if(!(0<c))throw"invalid cirTreeLength!";this.cirTreeOffset=d;this.cirTreeLength=c;this.isSummary=f},BED_COLOR_REGEXP:/^[0-9]+,[0-9]+,[0-9]+/,readWigData:function(a,d,c,f,b){(a=this.bwg.refsByName[a])?this.readWigDataById(a.id,d,c,f,b):f([])},readWigDataById:function(k,h,c,p,b){this.cirHeader?(new d(this,k,h,c,p,b)).cirFobRecur([this.cirTreeOffset+48],1):(k=f.hitch(this,"readWigDataById",
k,h,c,p,b),this.cirHeaderLoading?this.cirHeaderLoading.push(k):(this.cirHeaderLoading=[k],this.bwg.data.read(this.cirTreeOffset,48,f.hitch(this,function(b){this.cirHeader=b;this.cirBlockSize=this.bwg.newDataView(b,4,4).getUint32();a.forEach(this.cirHeaderLoading,function(a){a()});delete this.cirHeaderLoading}),b)))}})})},"JBrowse/Store/SeqFeature/BigWig/RequestWorker":function(){define("dojo/_base/declare,dojo/_base/lang,dojo/_base/array,JBrowse/Util,JBrowse/Util/RejectableFastPromise,dojo/promise/all,JBrowse/Model/Range,JBrowse/Model/SimpleFeature,jszlib/inflate,jszlib/arrayCopy".split(","),
function(p,f,a,d,k,h,c,o,b){var g=function(){console.log.apply(console,arguments)};return p(null,{BIG_WIG_TYPE_GRAPH:1,BIG_WIG_TYPE_VSTEP:2,BIG_WIG_TYPE_FSTEP:3,constructor:function(a,b,q,e,i,l){this.window=a;this.source=a.bwg.name||void 0;this.blocksToFetch=[];this.outstanding=0;this.chr=b;this.min=q;this.max=e;this.callback=i;this.errorCallback=l||function(e){console.error(e,e.stack,arguments.caller)}},cirFobRecur:function(a,b){this.outstanding+=a.length;for(var q=4+32*this.window.cirBlockSize,
e,i=0;i<a.length;++i){var l=new c(a[i],Math.min(a[i]+q,this.window.cirTreeOffset+this.window.cirTreeLength));e=e?e.union(l):l}q=e.ranges();for(e=0;e<q.length;++e)this.cirFobStartFetch(a,q[e],b)},cirFobStartFetch:function(a,b,q){var e=b.max()-b.min();this.window.bwg._read(b.min(),e,f.hitch(this,function(e){for(var l=0;l<a.length;++l)b.contains(a[l])&&(this.cirFobRecur2(e,a[l]-b.min(),q),--this.outstanding,0==this.outstanding&&this.cirCompleted())}),this.errorCallback)},cirFobRecur2:function(a,b,q){var a=
this.window.bwg.newDataView(a,b),e=a.getUint8(),b=a.getUint16(2);if(0!=e)for(e=0;e<b;++e){var i=a.getUint32(),l=a.getUint32(),c=a.getUint32(),d=a.getUint32(),g=a.getUint64(),q=a.getUint64();(i<this.chr||i==this.chr&&l<=this.max)&&(c>this.chr||c==this.chr&&d>=this.min)&&this.blocksToFetch.push({offset:g,size:q})}else{for(var n=[],e=0;e<b;++e)i=a.getUint32(),l=a.getUint32(),c=a.getUint32(),d=a.getUint32(),g=a.getUint64(),(i<this.chr||i==this.chr&&l<=this.max)&&(c>this.chr||c==this.chr&&d>=this.min)&&
n.push(g);0<n.length&&this.cirFobRecur(n,q+1)}},cirCompleted:function(){this.blockGroupsToFetch=this.groupBlocks(this.blocksToFetch);0==this.blockGroupsToFetch.length?this.callback([]):(this.features=[],this.readFeatures())},groupBlocks:function(a){a.sort(function(a,e){return(a.offset|0)-(e.offset|0)});for(var b=[],c,e,i=0;i<a.length;i++)c&&2E3>=a[i].offset-e?(c.size+=a[i].size-e+a[i].offset,c.blocks.push(a[i])):b.push(c={blocks:[a[i]],size:a[i].size,offset:a[i].offset}),e=c.offset+c.size;return b},
createFeature:function(a,b,c){var a={start:a,end:b,source:this.source},e;for(e in c)a[e]=c[e];this.features.push(new o({data:a}))},maybeCreateFeature:function(a,b,c){a<=this.max&&b>=this.min&&this.createFeature(a,b,c)},parseSummaryBlock:function(a,b){for(var c=this.window.bwg.newDataView(a,b),e=a.byteLength/32,i=0;i<e;++i){var l=c.getInt32(),d=c.getInt32(),g=c.getInt32(),f=c.getInt32()||1,n=c.getFloat32(),h=c.getFloat32(),k=c.getFloat32();c.getFloat32();if(l==this.chr){l={score:k/f,maxScore:h,minScore:n};
if("bigbed"==this.window.bwg.type)l.type="density";this.maybeCreateFeature(d,g,l)}}},parseBigWigBlock:function(a,b){var c=this.window.bwg.newDataView(a,b),e=c.getUint32(16),i=c.getUint8(20),l=c.getUint16(22);if(i==this.BIG_WIG_TYPE_FSTEP)for(var d=c.getInt32(4),f=c.getUint32(12),i=0;i<l;++i){var h=c.getFloat32(4*i+24);this.maybeCreateFeature(d+i*f,d+i*f+e,{score:h})}else if(i==this.BIG_WIG_TYPE_VSTEP)for(i=0;i<l;++i)d=c.getInt32(8*i+24),h=c.getFloat32(),this.maybeCreateFeature(d,d+e,{score:h});else if(i==
this.BIG_WIG_TYPE_GRAPH)for(i=0;i<l;++i)d=c.getInt32(12*i+24),e=c.getInt32(),h=c.getFloat32(),d>e&&(d=e),this.maybeCreateFeature(d,e,{score:h});else g("Currently not handling bwgType="+i)},parseBigBedBlock:function(a,b){for(var d=this.window.bwg.newDataView(a,b),e=0;e<a.length;){for(var i=d.getUint32(e),l=d.getInt32(e+4),g=d.getInt32(e+8),e=e+12,h="";e<a.length;){var f=d.getUint8(e++);if(0!=f)h+=String.fromCharCode(f);else break}var f={},n=h.split("\t");if(0<n.length)f.label=n[0];if(1<n.length)f.score=
parseInt(n[1]);if(2<n.length)f.orientation=n[2];if(5<n.length&&(h=n[5],this.window.BED_COLOR_REGEXP.test(h)))f.override_color="rgb("+h+")";if(9>n.length)i==this.chr&&this.maybeCreateFeature(l,g,f);else if(i==this.chr&&l<=this.max&&g>=this.min){var i=n[3]|0,g=n[4]|0,h=n[6]|0,k=n[7].split(","),p=n[8].split(",");f.type="bb-transcript";var o=new Feature;o.id=n[0];o.type="bb-transcript";o.notes=[];f.groups=[o];if(10<n.length){var o=n[9],n=n[10],r=new Feature;r.id=o;r.label=n;r.type="gene";f.groups.push(r)}n=
null;for(o=0;o<h;++o)r=(p[o]|0)+l,r=new c(r,r+(k[o]|0)),n=n?n.union(r):r;k=n.ranges();for(l=0;l<k.length;++l)h=k[l],this.createFeature(h.min(),h.max(),f);if(g>i&&(l=n.intersection(new c(i,g)))){f.type="bb-translation";i=l.ranges();for(l=0;l<i.length;++l)h=i[l],this.createFeature(h.min(),h.max(),f)}}}},readFeatures:function(){var c=this,d=a.map(c.blockGroupsToFetch,function(a){var e=new k;c.window.bwg._read(a.offset,a.size,function(b){a.data=b;e.resolve(a)},f.hitch(e,"reject"));return e},c);h(d).then(function(d){a.forEach(d,
function(e){a.forEach(e.blocks,function(a){var d=a.offset-e.offset;0<c.window.bwg.uncompressBufSize?(a=b(e.data,d+2,a.size-2),d=0):a=e.data;c.window.isSummary?c.parseSummaryBlock(a,d):"bigwig"==c.window.bwg.type?c.parseBigWigBlock(a,d):"bigbed"==c.window.bwg.type?c.parseBigBedBlock(a,d):g("Don't know what to do with "+c.window.bwg.type)})});c.callback(c.features)},c.errorCallback)}})})},"JBrowse/Util/RejectableFastPromise":function(){define([],function(){var p=function(){this.callbacks=[];this.errbacks=
[]};p.prototype.then=function(f,a){"value"in this?f(this.value):"error"in this?a(this.error):(this.callbacks.push(f),this.errbacks.push(a))};p.prototype.resolve=function(f){this.value=f;delete this.errbacks;f=this.callbacks;delete this.callbacks;for(var a=0;a<f.length;a++)f[a](this.value)};p.prototype.reject=function(f){this.error=f;delete this.callbacks;var a=this.errbacks;delete this.errbacks;for(var d=0;d<a.length;d++)a[d](f)};return p})},"JBrowse/Model/Range":function(){define("JBrowse/Model/Range",
["dojo/_base/declare"],function(p){var f=p(null,{constructor:function(){this._ranges=2==arguments.length?[{min:arguments[0],max:arguments[1]}]:0 in arguments[0]?dojo.clone(arguments[0]):[arguments[0]]},min:function(){return this._ranges[0].min},max:function(){return this._ranges[this._ranges.length-1].max},contains:function(a){for(var d=0;d<this._ranges.length;++d){var f=this._ranges[d];if(f.min<=a&&f.max>=a)return!0}return!1},isContiguous:function(){return 1<this._ranges.length},ranges:function(){return this._ranges.map(function(a){return new f(a.min,
a.max)})},toString:function(){return this._ranges.map(function(a){return"["+a.min+"-"+a.max+"]"}).join(",")},union:function(a){for(var a=this.ranges().concat(a.ranges()).sort(this.rangeOrder),d=[],k=a[0],h=1;h<a.length;++h){var c=a[h];c.min()>k.max()+1?(d.push(k),k=c):c.max()>k.max()&&(k=new f(k.min(),c.max()))}d.push(k);return 1==d.length?d[0]:new _Compound(d)},intersection:function(a){for(var d,k=this.ranges(),h=a.ranges(),c=k.length,o=h.length,b=0,g=0,j=[];b<c&&g<o;){d=k[b];var a=h[g],m=Math.max(d.min(),
a.min()),p=Math.min(d.max(),a.max());p>=m&&j.push(new f(m,p));d.max()>a.max()?++g:++b}return 0==j.length?null:1==j.length?j[0]:new _Compound(j)},coverage:function(){for(var a=0,d=this.ranges(),f=0;f<d.length;++f)var h=d[f],a=a+(h.max()-h.min()+1);return a},rangeOrder:function(a,d){2>arguments.length&&(d=a,a=this);return a.min()<d.min()?-1:a.min()>d.min()?1:a.max()<d.max()?-1:d.max()>a.max()?1:0}});return f})}}});
define("JBrowse/Store/SeqFeature/BigWig","dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/_base/url,JBrowse/Model/DataView,JBrowse/has,JBrowse/Errors,JBrowse/Store/SeqFeature,JBrowse/Store/DeferredStatsMixin,JBrowse/Store/DeferredFeaturesMixin,./BigWig/Window,JBrowse/Util,JBrowse/Model/XHRBlob".split(","),function(p,f,a,d,k,h,c,o,b,g,j,m,q){return p([o,b,g],{BIG_WIG_MAGIC:-2003829722,BIG_BED_MAGIC:-2021002517,BIG_WIG_TYPE_GRAPH:1,BIG_WIG_TYPE_VSTEP:2,BIG_WIG_TYPE_FSTEP:3,_littleEndian:!0,
constructor:function(a){this.data=a.blob||new q(this.resolveUrl(a.urlTemplate||"data.bigwig"));this.name=a.name||this.data.url&&(new d(this.data.url)).path.replace(/^.+\//,"")||"anonymous";this._load()},_defaultConfig:function(){return m.deepUpdate(dojo.clone(this.inherited(arguments)),{chunkSizeLimit:3E7})},_getGlobalStats:function(a){var b=this._globalStats||{};if(!("scoreMean"in b))b.scoreMean=b.basesCovered?b.scoreSum/b.basesCovered:0;if(!("scoreStdDev"in b))b.scoreStdDev=this._calcStdFromSums(b.scoreSum,
b.scoreSumSquares,b.basesCovered);a(b)},_read:function(a,b,d,f){b>this.config.chunkSizeLimit?f(new c.DataOverflow("Too much data. Chunk size "+m.commifyNumber(b)+" bytes exceeds chunkSizeLimit of "+m.commifyNumber(this.config.chunkSizeLimit)+".")):this.data.read.apply(this.data,arguments)},_load:function(){this._read(0,512,f.hitch(this,function(a){if(a){var b=this.newDataView(a),c=b.getInt32();if(c!=this.BIG_WIG_MAGIC&&c!=this.BIG_BED_MAGIC&&(this._littleEndian=!1,b=this.newDataView(a),b.getInt32()!=
this.BIG_WIG_MAGIC&&c!=this.BIG_BED_MAGIC)){console.error("Not a BigWig or BigBed file");deferred.reject("Not a BigWig or BigBed file");return}this.type=c==this.BIG_BED_MAGIC?"bigbed":"bigwig";(this.fileSize=a.fileSize)||console.warn("cannot get size of BigWig/BigBed file, widest zoom level not available");this.version=b.getUint16();this.numZoomLevels=b.getUint16();this.chromTreeOffset=b.getUint64();this.unzoomedDataOffset=b.getUint64();this.unzoomedIndexOffset=b.getUint64();this.fieldCount=b.getUint16();
this.definedFieldCount=b.getUint16();this.asOffset=b.getUint64();this.totalSummaryOffset=b.getUint64();this.uncompressBufSize=b.getUint32();this.zoomLevels=[];for(c=0;c<this.numZoomLevels;++c){var d=b.getUint32(4*(6*c+16)),g=b.getUint64(4*(6*c+18)),h=b.getUint64(4*(6*c+20));this.zoomLevels.push({reductionLevel:d,dataOffset:g,indexOffset:h})}this.totalSummaryOffset?function(){var b=this.newDataView(a,this.totalSummaryOffset);this._globalStats={basesCovered:b.getUint64(),scoreMin:b.getFloat64(),scoreMax:b.getFloat64(),
scoreSum:b.getFloat64(),scoreSumSquares:b.getFloat64()}}.call(this):console.warn("BigWig "+this.data.url+" has no total summary data.");this._readChromTree(function(){this._deferred.features.resolve({success:!0});this._deferred.stats.resolve({success:!0})},f.hitch(this,"_failAllDeferred"))}else this._failAllDeferred("BBI header not readable")}),f.hitch(this,"_failAllDeferred"))},newDataView:function(a,b,c){return new k(a,b,c,this._littleEndian)},_readChromTree:function(a,b){var c=this;this.refsByNumber=
{};this.refsByName={};for(var d=this.unzoomedDataOffset;0!=d%4;)++d;this._read(this.chromTreeOffset,d-this.chromTreeOffset,function(b){if(h("typed-arrays")){var d=c.newDataView(b);if(2026540177!==d.getUint32())throw"parse error: not a Kent bPlusTree";d.getUint32();var i=d.getUint32();d.getUint32();d.getUint64();var f=function(a){if(a>=b.length)throw"reading beyond end of buffer";for(var e=d.getUint8(a),g=d.getUint16(a+2),a=a+4,h=0;h<g;++h)if(e){for(var j="",k=0;k<i;++k){var m=d.getUint8(a++);0!=m&&
(j+=String.fromCharCode(m))}k=d.getUint32(a);m=d.getUint32(a+4);a+=8;m={name:j,id:k,length:m};c.refsByName[c.browser.regularizeReferenceName(j)]=m;c.refsByNumber[k]=m}else a+=i,j=d.getUint64(a),a+=8,j-=c.chromTreeOffset,f(j)};f(32);a.call(c,c)}else c._failAllDeferred("Web browser does not support typed arrays")},b)},hasRefSeq:function(a,b,c){var d=this,a=d.browser.regularizeReferenceName(a);this._deferred.features.then(function(){b(a in d.refsByName)},c)},_getFeatures:function(b,c,d,f){var g=this.browser.regularizeReferenceName(b.ref),
h=b.start,j=b.end;(b=b.basesPerSpan?this.getView(1/b.basesPerSpan):b.scale?this.getView(b.scale):this.getView(1))?b.readWigData(g,h,j,dojo.hitch(this,function(b){a.forEach(b||[],c);d()}),f):d()},getUnzoomedView:function(){if(!this.unzoomedView){var a=4E3;this.zoomLevels[0]&&(a=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset);this.unzoomedView=new j(this,this.unzoomedIndexOffset,a,!1)}return this.unzoomedView},getView:function(a){if(!this.zoomLevels||!this.zoomLevels.length)return null;if(!this._viewCache||
this._viewCache.scale!=a)this._viewCache={scale:a,view:this._getView(a)};return this._viewCache.view},_getView:function(a){var a=1/a,b=this.zoomLevels.length;for(this.fileSize||b--;0<b;b--){var c=this.zoomLevels[b];if(c&&c.reductionLevel<=2*a)return new j(this,c.indexOffset,b<this.zoomLevels.length-1?this.zoomLevels[b+1].dataOffset-c.indexOffset:this.fileSize-4-c.indexOffset,!0)}return this.getUnzoomedView()}})});